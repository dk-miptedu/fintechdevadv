# Концепция Бота

Финансовый чат-бот Telegram управляет портфелем криптовалют и предлагает два сценария: "Анализ из прошлого" и "Взгляд в будущее".

## 1. Концепция бота

**Финансовый чат-бот для Telegram:**

Этот бот предназначен для помощи пользователям в управлении криптовалютными портфелями. Он предоставляет аналитику по инвестициям в криптовалюту, используя исторические данные и прогнозы. Бот имеет два основных сценария взаимодействия:

- **Сценарий "Анализ из прошлого":** Пользователи могут увидеть, как изменился бы их портфель, если бы они инвестировали в криптовалюту в прошлом. Это позволяет проверить эффективность выбранной стратегии и анализировать исторические данные.
- **Сценарий "Взгляд в будущее":** Бот создает прогнозы и рекомендации по инвестициям на основе исторических данных, помогая пользователям планировать свои инвестиции на ближайший год.

```plantuml
@startuml Basic Sample
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

Person(admin, "Administrator")
System_Boundary(c1, "Sample System") {
    Container(web_app, "Web Application", "C#, ASP.NET Core 2.1 MVC", "Allows users to compare multiple Twitter timelines")
}
System(twitter, "Twitter")

Rel(admin, web_app, "Uses", "HTTPS")
Rel(web_app, twitter, "Gets tweets from", "HTTPS")
@enduml
```

## 2. Функции бота

**Функции:**

1. **Регистрация пользователя:**

   - Сохранение Telegram-идентификатора.
   - Сохранение информации о пользователе (например, предпочтения и текущий портфель).
2. **Сценарий "Анализ из прошлого":**

   - Ввод данных о начальных инвестициях.
   - Запрос исторических данных от внешних сервисов.
   - Анализ и отображение результатов по портфелю.
3. **Сценарий "Взгляд в будущее":**

   - Запрос текущих данных о криптовалютах.
   - Формирование прогнозов на основе исторических данных и моделей.
   - Предоставление рекомендаций по инвестициям.
4. **Анализ портфеля:**

   - Отображение текущей стоимости портфеля.
   - Анализ успешных сделок и изменений стоимости.
5. **Имитация инвестиционных сценариев:**

   - Создание и тестирование различных инвестиционных стратегий.
   - Предоставление результатов и рекомендаций по сценариям.

## 3. Компоненты и интеграции

**Компоненты:**

1. **Telegram-клиент:**

   - Обработка входящих и исходящих сообщений.
   - Отображение данных и взаимодействие с пользователем.
2. **Исполняющий слой (фреймворк):**

   - Обработка логики бота.
   - Взаимодействие с базой данных и внешними сервисами.
   - Формирование ответов для пользователей.
3. **СУБД:**

   - Хранение информации о пользователях.
   - Сохранение данных о портфелях и инвестициях.
   - Хранение исторических данных и результатов анализа.
4. **Интегрируемые сервисы:**

   - **Yahoo! Finance:** Получение данных о курсах криптовалют.
   - **bestchange.ru:** Информация об обменных курсах.
   - **cripta.cc:** Данные о криптовалютах.
   - **kukoin.com:** Торговые данные.
   - **Банк России:** Официальные обменные курсы и другие финансовые данные.
5. **Дополнительные компоненты (опционально):**

   - Модули для выполнения сложных расчетов.
   - Интерфейсы для работы с прогнозными моделями.

## 4. Диаграмма компонентов

**Диаграмма компонентов может выглядеть следующим образом:**

```
+--------------------+       +-----------------+
| Telegram-клиент    | <---> | Исполняющий слой|
|                    |       | (Фреймворк)     |
+--------------------+       +-----------------+
                                     |
                                     v
                             +----------------+
                             |       СУБД      |
                             +----------------+
                                    /|\
                                     |
      +---------------------+       +----------------+
      | Внешние сервисы     | <---> | Дополнительные  |
      | (Yahoo! Finance,    |       | компоненты     |
      | bestchange.ru,      |       +----------------+
      | cripta.cc,          |
      | kukoin.com, Банк    |
      | России)             |
      +---------------------+
```

## 5. Диаграмма последовательности

**Пример диаграммы последовательности для сценария "Прошлое":**

1. **Регистрация пользователя:**

   - Пользователь → Telegram-клиент → Исполняющий слой: Команда регистрации.
   - Исполняющий слой → СУБД: Сохранение данных пользователя.
   - СУБД → Исполняющий слой: Подтверждение сохранения.
   - Исполняющий слой → Telegram-клиент: Сообщение о успешной регистрации.
2. **Сценарий "Прошлое":**

   - Пользователь → Telegram-клиент → Исполняющий слой: Запрос на анализ "Прошлое".
   - Исполняющий слой → Внешние сервисы: Запрос исторических данных о криптовалютах.
   - Внешние сервисы → Исполняющий слой: Ответ с данными.
   - Исполняющий слой → СУБД: Получение данных о портфеле.
   - СУБД → Исполняющий слой: Данные о портфеле.
   - Исполняющий слой → Telegram-клиент: Отображение результатов анализа.
3. **Сценарий "Будущее":**

   - Пользователь → Telegram-клиент → Исполняющий слой: Запрос на анализ "Будущее".
   - Исполняющий слой → Внешние сервисы: Запрос текущих данных о криптовалютах.
   - Внешние сервисы → Исполняющий слой: Ответ с данными.
   - Исполняющий слой → СУБД: Анализ данных и формирование прогноза.
   - СУБД → Исполняющий слой: Данные для прогноза.
   - Исполняющий слой → Telegram-клиент: Рекомендации по инвестициям.

Давайте продолжим с дополнительными деталями, которые могут быть полезны для реализации проекта:

## 6. Хранилище данных и структура СУБД

**СУБД** должна обеспечивать хранение и управление следующими типами данных:

1. **Данные о пользователях:**

   - Telegram ID (уникальный идентификатор пользователя).
   - Информация о зарегистрированных пользователях (имя, контактные данные и т.д.).
   - Исторические данные по инвестициям и портфелям.
2. **Информация о портфелях:**

   - История транзакций.
   - Данные о текущем состоянии портфеля.
   - Инвестиционные стратегии и их результаты.
3. **Исторические данные:**

   - Данные о курсах криптовалют за разные периоды.
   - Обменные курсы и финансовые показатели.
4. **Прогнозные данные:**

   - Модели прогнозирования.
   - Результаты прогнозов и рекомендации.

**Структура базы данных:**

Пример таблиц для базы данных:

- **Users:**

  - `user_id` (PRIMARY KEY)
  - `telegram_id`
  - `name`
  - `contact_info`
- **Portfolios:**

  - `portfolio_id` (PRIMARY KEY)
  - `user_id` (FOREIGN KEY)
  - `creation_date`
  - `current_value`
- **Transactions:**

  - `transaction_id` (PRIMARY KEY)
  - `portfolio_id` (FOREIGN KEY)
  - `transaction_date`
  - `amount`
  - `type` (buy/sell)
- **HistoricalData:**

  - `data_id` (PRIMARY KEY)
  - `date`
  - `crypto_symbol`
  - `price`
  - `exchange_rate`
- **Forecasts:**

  - `forecast_id` (PRIMARY KEY)
  - `portfolio_id` (FOREIGN KEY)
  - `forecast_date`
  - `expected_return`
  - `strategy_details`

## 7. Модели прогнозирования и аналитика

Для сценария "Будущее" будет необходимо разработать или интегрировать модели прогнозирования. Рассмотрите использование таких методов, как:

- **Временные ряды:** для прогнозирования цен криптовалют на основе исторических данных.
- **Машинное обучение:** модели для предсказания трендов и изменений на основе различных факторов.
- **Эконометрические модели:** для анализа финансовых данных и формирования стратегий.

## 8. Интерфейсы и API

**Интерфейсы для интеграции:**

1. **Yahoo! Finance API:**

   - Используйте для получения исторических данных о курсах криптовалют и обменных курсах.
2. **Bestchange.ru API:**

   - Получение актуальных обменных курсов и информации о криптовалютах.
3. **Cripta.cc API:**

   - Данные о курсах криптовалют и рыночной капитализации.
4. **KuCoin API:**

   - Торговые данные и информация о текущих курсах.
5. **Банк России API:**

   - Обменные курсы и финансовые показатели.

**Пример API запросов:**

- **Yahoo Finance API:**

  ```http
  GET https://api.yahoo.com/finance/v1/crypto?symbol=BTC-USD
  ```
- **Bestchange.ru API:**

  ```http
  GET https://bestchange.ru/api/v1/rates
  ```
- **Cripta.cc API:**

  ```http
  GET https://api.cripta.cc/v1/cryptocurrencies
  ```
- **KuCoin API:**

  ```http
  GET https://api.kucoin.com/api/v1/market/stats?symbol=BTC-USDT
  ```
- **Банк России API:**

  ```http
  GET https://www.cbr.ru/scripts/XML_daily.asp?date_req=30/09/2024
  ```

## 9. Безопасность и управление данными

- **Аутентификация и авторизация:**

  - Убедитесь, что только зарегистрированные пользователи могут получать доступ к своим данным и выполнять транзакции.
- **Шифрование данных:**

  - Все данные, передаваемые между ботом и внешними сервисами, должны быть защищены с помощью HTTPS.
- **Резервное копирование:**

  - Регулярное резервное копирование базы данных для защиты от потери данных.
- **Политика конфиденциальности:**

  - Пользователи должны быть информированы о том, как их данные используются и хранятся.

## 10. Тестирование и развертывание

**Тестирование:**

- Проведите тестирование функциональности бота в разных сценариях.
- Проверьте интеграции с внешними сервисами и корректность данных.
- Протестируйте работу бота в условиях высокой нагрузки.

**Развертывание:**

- Разверните бота на надежном сервере или облачной платформе.
- Обеспечьте мониторинг и поддержку бота для обеспечения его бесперебойной работы.
